# üìä Changelog - –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### Backend

#### 1. –ú–æ–¥—É–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (`backend/app/statistics.py`)

–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:
- `get_offer_statistics()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ñ—Ñ–µ—Ä–∞–º
- `get_brand_statistics()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±—Ä–µ–Ω–¥–∞–º
- `get_daily_statistics()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è–º
- `get_hourly_statistics()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∞—Å–∞–º
- `get_top_offers()` - –¢–û–ü –æ—Ñ—Ñ–µ—Ä–æ–≤
- `get_conversion_rate()` - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –∏ –º–µ—Ç—Ä–∏–∫–∏
- `get_subscriber_statistics()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º
- `get_offer_performance()` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ñ—Ñ–µ—Ä–∞
- `get_dashboard_summary()` - —Å–≤–æ–¥–∫–∞ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞

#### 2. API Views (`backend/app/statistics_views.py`)

REST API endpoints:
- `GET /api/statistics/` - HTML –¥–∞—à–±–æ—Ä–¥ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- `GET /api/statistics/dashboard/?days=30` - JSON –¥–∞—à–±–æ—Ä–¥
- `GET /api/statistics/offers/?days=30` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ñ—Ñ–µ—Ä–∞–º
- `GET /api/statistics/offers/<offer_id>/?days=30` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ñ—Ñ–µ—Ä–∞
- `GET /api/statistics/brands/?days=30` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –±—Ä–µ–Ω–¥–∞–º
- `GET /api/statistics/daily/?days=30` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–Ω—è–º
- `GET /api/statistics/top-offers/?limit=10&days=30` - –¢–û–ü –æ—Ñ—Ñ–µ—Ä–æ–≤
- `GET /api/statistics/conversion/?days=30` - –∫–æ–Ω–≤–µ—Ä—Å–∏—è
- `GET /api/statistics/subscribers/` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º

#### 3. HTML –î–∞—à–±–æ—Ä–¥ (`backend/app/templates/admin/statistics_dashboard.html`)

–ö—Ä–∞—Å–∏–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ (7/30/90 –¥–Ω–µ–π)
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
- –¢–∞–±–ª–∏—Ü–∞ –¢–û–ü-10 –æ—Ñ—Ñ–µ—Ä–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

#### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Django Admin

**–í —Å–ø–∏—Å–∫–µ –æ—Ñ—Ñ–µ—Ä–æ–≤:**
- ‚úÖ **–í—Å–µ–≥–æ** - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤ (–∑–µ–ª—ë–Ω—ã–π —Ü–≤–µ—Ç)
- ‚úÖ **–°–µ–≥–æ–¥–Ω—è** - –∫–ª–∏–∫–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è (–æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ü–≤–µ—Ç)
- ‚úÖ **7 –¥–Ω–µ–π** - –∫–ª–∏–∫–∏ –∑–∞ –Ω–µ–¥–µ–ª—é (—Ç—ë–º–Ω–æ-—Å–∏–Ω–∏–π)
- ‚úÖ **30 –¥–Ω–µ–π** - –∫–ª–∏–∫–∏ –∑–∞ –º–µ—Å—è—Ü (—Å–∏–Ω–∏–π)
- ‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö** üë§ - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π)
- ‚úÖ **üìä –ü–æ–¥—Ä–æ–±–Ω–µ–µ** - —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

**–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ñ—Ñ–µ—Ä–∞:**
- –†–∞–∑–¥–µ–ª "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" —Å–æ –≤—Å–µ–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- –°–≤—ë—Ä–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∫–ª–∞—Å—Å `collapse`)
- –í—Å–µ –ø–æ–ª—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è

**–¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è:**
- –ê–∫—Ç–∏–≤–Ω—ã–µ –æ—Ñ—Ñ–µ—Ä—ã (–µ—Å—Ç—å –∫–ª–∏–∫–∏) - —Ü–≤–µ—Ç–Ω—ã–µ —á–∏—Å–ª–∞
- –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –æ—Ñ—Ñ–µ—Ä—ã (–Ω–µ—Ç –∫–ª–∏–∫–æ–≤) - —Å–µ—Ä—ã–π —Ü–≤–µ—Ç (#999)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **STATISTICS_QUICKSTART.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (2 –º–∏–Ω—É—Ç—ã)
2. **ADMIN_STATISTICS_GUIDE.md** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –∞–¥–º–∏–Ω–∫–µ
3. **STATISTICS_GUIDE.md** - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
4. **STATISTICS_API.md** - –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ API
5. **STATISTICS_CHANGELOG.md** - —ç—Ç–æ—Ç —Ñ–∞–π–ª
6. **README.md** - –æ–±–Ω–æ–≤–ª—ë–Ω —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ü—Ä–æ—Å–º–æ—Ç—Ä —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

1. –û—Ç–∫—Ä–æ–π—Ç–µ: `http://localhost:8000/api/statistics/`
2. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ (7/30/90 –¥–Ω–µ–π)
4. –ò–∑—É—á–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏!

### –ß–µ—Ä–µ–∑ API

```bash
# –ü–æ–ª—É—á–∏—Ç—å –¥–∞—à–±–æ—Ä–¥ –∑–∞ 30 –¥–Ω–µ–π
curl "http://localhost:8000/api/statistics/dashboard/?days=30"

# –ü–æ–ª—É—á–∏—Ç—å –¢–û–ü-5 –æ—Ñ—Ñ–µ—Ä–æ–≤
curl "http://localhost:8000/api/statistics/top-offers/?limit=5&days=7"

# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—Ñ—Ñ–µ—Ä–∞
curl "http://localhost:8000/api/statistics/offers/offer-123/?days=30"
```

### –í –∞–¥–º–∏–Ω–∫–µ

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–û—Ñ—Ñ–µ—Ä—ã"
2. –ù–∞–π–¥–∏—Ç–µ –∫–æ–ª–æ–Ω–∫—É "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
3. –ù–∞–∂–º–∏—Ç–µ "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ –æ—Ñ—Ñ–µ—Ä–∞

## –ú–µ—Ç—Ä–∏–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

- **total_clicks** - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–∫–æ–≤
- **unique_users** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **conversion_rate** - –∫–æ–Ω–≤–µ—Ä—Å–∏—è (%)
- **avg_clicks_per_user** - —Å—Ä–µ–¥–Ω–µ–µ –∫–ª–∏–∫–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏

- –ü–æ –æ—Ñ—Ñ–µ—Ä–∞–º
- –ü–æ –±—Ä–µ–Ω–¥–∞–º
- –ü–æ –¥–Ω—è–º
- –ü–æ —á–∞—Å–∞–º

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Django ORM —Ñ—É–Ω–∫—Ü–∏–∏:
- `Count()` - –ø–æ–¥—Å—á—ë—Ç
- `TruncDate()` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–Ω—è–º
- `TruncHour()` - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —á–∞—Å–∞–º
- `Q()` - —Å–ª–æ–∂–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã

–ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
- –ú–∏–Ω–∏–º—É–º –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –ë–î
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `created_at`, `vk_user_id`, `offer_id`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥ –∑–∞–ø—Ä–æ—Å–∞

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- HTML –¥–∞—à–±–æ—Ä–¥ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º (`@staff_member_required`)
- API endpoints –Ω–µ —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Python

```python
import requests

response = requests.get('http://localhost:8000/api/statistics/dashboard/?days=30')
data = response.json()

print(f"–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤: {data['data']['total_clicks']}")
print(f"–ö–æ–Ω–≤–µ—Ä—Å–∏—è: {data['data']['conversion']['conversion_rate']}%")

for offer in data['data']['top_offers']:
    print(f"{offer['offer__partner_name']}: {offer['total_clicks']} –∫–ª–∏–∫–æ–≤")
```

### JavaScript

```javascript
fetch('/api/statistics/top-offers/?limit=5&days=7')
  .then(response => response.json())
  .then(data => {
    data.data.forEach(offer => {
      console.log(`${offer.offer__partner_name}: ${offer.total_clicks} –∫–ª–∏–∫–æ–≤`);
    });
  });
```

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/Excel
- [ ] –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (Chart.js)
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤
- [ ] –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–¥–æ–≤
- [ ] –ö–æ–≥–æ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ñ—Ñ–µ—Ä–æ–≤
- [ ] Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö
- [ ] –í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
- [ ] –ì–µ–æ–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (–µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≥–µ–æ–¥–∞–Ω–Ω—ã–µ)
- [ ] –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∏–¥–µ–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
1. –û–ø–∏—à–∏—Ç–µ, –∫–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –≤–∞–º –Ω—É–∂–Ω—ã
2. –ö–∞–∫–∏–µ –æ—Ç—á—ë—Ç—ã —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –≤–∏–¥–µ—Ç—å
3. –ö–∞–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –±—ã–ª–∏ –±—ã –ø–æ–ª–µ–∑–Ω—ã

## –í–µ—Ä—Å–∏—è

**v1.0.0** - –ü–µ—Ä–≤—ã–π —Ä–µ–ª–∏–∑ —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- HTML –¥–∞—à–±–æ—Ä–¥
- REST API
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–¥–º–∏–Ω–∫–æ–π

